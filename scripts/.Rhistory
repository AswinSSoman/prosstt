toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16)
t1 <- 10
t2 <- 0
t3 <- 0
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16)
t1 <- 0
t2 <- 0
t3 <- 0
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16)
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][1:2,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][48:52,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][99:100,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][233:234,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][1:2,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][25:26,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][30:31,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][1:21,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][5:10,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][11:15,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,4)], pch=16, col=labels, main=test, size=7)
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
plot3d(eigenvectors(dif)[,c(1,2,5)], pch=16, col=labels, main=test, size=7)
plot3d(eigenvectors(dif)[,c(1,2,6)], pch=16, col=labels, main=test, size=7)
plot3d(eigenvectors(dif)[,c(1,2,7)], pch=16, col=labels, main=test, size=7)
plot3d(eigenvectors(dif)[,c(1,2,8)], pch=16, col=labels, main=test, size=7)
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][11:15,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][15:20,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][18:20,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][16:18,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][18,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][18,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][18:19,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][16:17,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][15:16,], size=12, col="green")
points3d(eigenvectors(dif)[,c(1,2,3)][15:16,], size=15, col="green")
points3d(eigenvectors(dif)[,c(1,2,3)][16:17,], size=15, col="red")
points3d(eigenvectors(dif)[,c(1,2,3)][48:52,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][49:50,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][48:49,], size=15, col="green")
points3d(eigenvectors(dif)[,c(1,2,3)][99:100,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][90:100,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][90:92,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][92:93,], size=13, col="green")
points3d(eigenvectors(dif)[,c(1,2,3)][233:234,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][232:233,], size=13, col="green")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][199:201,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][195:201,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][145:155,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][149:151,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][148:149,], size=15, col="green")
points3d(eigenvectors(dif)[,c(1,2,3)][199:201,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][199:201,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][200:201,], size=15, col="green")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][endpoints,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][199:201,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][48:49,], size=15, col="green")
points3d(eigenvectors(dif)[,c(1,2,3)][16:17,], size=15, col="red")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
endpoints <- c(17, 92, 199, 234)
points3d(eigenvectors(dif)[,c(1,2,3)][endpoints,], size=12, col="black")
endpoints <- c(1, 92, 199, 234)
points3d(eigenvectors(dif)[,c(1,2,3)][endpoints,], size=12, col="black")
endpoints <- c(20, 92, 199, 234)
points3d(eigenvectors(dif)[,c(1,2,3)][endpoints,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][16:17,], size=15, col="red")
endpoints <- c(16, 92, 199, 234)
points3d(eigenvectors(dif)[,c(1,2,3)][endpoints,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
points3d(eigenvectors(dif)[,c(1,2,3)][endpoints,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][branchpoints,], size=12, col="black")
plot3d(eigenvectors(dif)[,c(1,2,3)], pch=16, col=labels, main=test, size=7)
endpoints <- c(16, 92, 199, 234)
branchpoints <- c(50, 150)
points3d(eigenvectors(dif)[,c(1,2,3)][endpoints,], size=12, col="black")
points3d(eigenvectors(dif)[,c(1,2,3)][branchpoints,], size=12, col="black")
write.table(x = t(eigenvectors(dif)[,1:4][endpoints,]), file="~/Desktop/bif2_prosstt/endpoints.txt", sep = "\t", row.names = F, col.names = F)
write.table(x = t(eigenvectors(dif)[,1:4][branchpoints,]), file="~/Desktop/bif2_prosstt/branchpoints.txt", sep = "\t", row.names = F, col.names = F)
write.table(x = eigenvectors(dif)[,1:4], file="~/Desktop/bif2_prosstt/all.txt", sep = "\t", row.names = F, col.names = F)
write.table(x = t(eigenvectors(dif)[,1:3][endpoints,]), file="~/Desktop/bif2_prosstt/endpoints.txt", sep = "\t", row.names = F, col.names = F)
write.table(x = t(eigenvectors(dif)[,1:3][branchpoints,]), file="~/Desktop/bif2_prosstt/branchpoints.txt", sep = "\t", row.names = F, col.names = F)
write.table(x = eigenvectors(dif)[,1:3], file="~/Desktop/bif2_prosstt/all.txt", sep = "\t", row.names = F, col.names = F)
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 0
t3 <- 0
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 0
t3 <- -10
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 0
t3 <- -40
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 0
t3 <- 40
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 0
t3 <- 60
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 0
t3 <- 80
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 0
t3 <- 90
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 20
t3 <- 90
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- -20
t3 <- 90
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 0
t2 <- 0
t3 <- 90
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 20
t2 <- 0
t3 <- 90
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 10
t2 <- 0
t3 <- 90
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 10
t2 <- 0
t3 <- 100
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 10
t2 <- 10
t3 <- 100
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 10
t2 <- -10
t3 <- 100
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 10
t2 <- 0
t3 <- 100
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 20
t2 <- 0
t3 <- 100
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
t1 <- 10
t2 <- 0
t3 <- 100
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
CellCoordinates <- toplot
pal_labels <- brewer.pal(length(unique(labels)), "Set2")
library(RColorBrewer)
library(viridis)
pal_labels <- brewer.pal(length(unique(labels)), "Set2")
colorcells=pal_labels[labels]
plot(CellCoordinates[,1], CellCoordinates[,2], pch=16, col="black",
xlab="DC1", ylab="DC2", cex=2, cex.lab=1.5, cex.axis=1.5)
points(CellCoordinates[,1], CellCoordinates[,2], pch=16, col=colorcells,
xlab="DC1", ylab="DC2", cex=1.5, cex.lab=1.5, cex.axis=1.5)
svg(filename="~/Documents/presentations/2017-04_PROSSTT_paper/pics/double_bif.svg", height=4.8, width=6)
par(mar=c(4.1, 5.1, 2.1, 5.1))
plot(CellCoordinates[,1], CellCoordinates[,2], pch=16, col="black",
xlab="DC1", ylab="DC2", cex=2, cex.lab=1.5, cex.axis=1.5)
points(CellCoordinates[,1], CellCoordinates[,2], pch=16, col=colorcells,
xlab="DC1", ylab="DC2", cex=1.5, cex.lab=1.5, cex.axis=1.5)
legend("right", legend=levels(ds$branch), pt.bg=pal_labels, pch=21, title="Branch",
xpd=TRUE, inset=c(-0.25,0), bty="n", cex=1.5)
dev.off()
svg(filename="~/Documents/presentations/2017-04_PROSSTT_paper/pics/double_bif.svg", height=4.8, width=6)
par(mar=c(4.1, 5.1, 2.1, 5.1))
plot(CellCoordinates[,1], CellCoordinates[,2], pch=16, col="black",
xlab="DC1", ylab="DC2", cex=2, cex.lab=1.5, cex.axis=1.5)
points(CellCoordinates[,1], CellCoordinates[,2], pch=16, col=colorcells,
xlab="DC1", ylab="DC2", cex=1.5, cex.lab=1.5, cex.axis=1.5)
legend("right", legend=levels(labels), pt.bg=pal_labels, pch=21, title="Branch",
xpd=TRUE, inset=c(-0.25,0), bty="n", cex=1.5)
labels
unique(labels)
dev.off()
dev.off()
svg(filename="~/Documents/presentations/2017-04_PROSSTT_paper/pics/double_bif.svg", height=4.8, width=6)
par(mar=c(4.1, 5.1, 2.1, 5.1))
plot(CellCoordinates[,1], CellCoordinates[,2], pch=16, col="black",
xlab="DC1", ylab="DC2", cex=2, cex.lab=1.5, cex.axis=1.5)
points(CellCoordinates[,1], CellCoordinates[,2], pch=16, col=colorcells,
xlab="DC1", ylab="DC2", cex=1.5, cex.lab=1.5, cex.axis=1.5)
legend("right", legend=unique(labels), pt.bg=pal_labels, pch=21, title="Branch",
xpd=TRUE, inset=c(-0.25,0), bty="n", cex=1.5)
dev.off()
JobFolder <- "~/Documents/repos/prosstt/data/double/"
JobName <- "double_"
job <- paste(JobFolder, JobName, sep="")
raw <- read.table(file=paste(job, "simulation.txt", sep=""), sep="\t", header=T, row.names=1)
data <- as.matrix(raw)
library_size = apply(data, 1, sum)
data <- 1/library_size * data
labels <- read.table(paste(job, "cellparams.txt", sep=""))$branches + 1
dif <- DiffusionMap(data)
plot3d(eigenvectors(dif)[,1:3], pch=16, col=labels, main=test, size=7)
ds <- data.frame(DC1=eigenvectors(dif)[,1], DC2=eigenvectors(dif)[,2], DC3=eigenvectors(dif)[,3],
DC4=eigenvectors(dif)[,4], branch=labels)
ds <- data.frame(DC1=eigenvectors(dif)[,1], DC2=eigenvectors(dif)[,2], DC3=eigenvectors(dif)[,3],
DC4=eigenvectors(dif)[,4], branch=labels)
t1 <- 10
t2 <- 0
t3 <- 100
rotx = rotation_matrix(1, 2, t1)
roty = rotation_matrix(1, 3, t2)
rotz = rotation_matrix(2, 3, t3)
rot <- rotx %*% roty %*% rotz
coords = dif@eigenvectors[,1:3]
tcoords = coords %*% rot
toplot <- cbind(tcoords[,1], tcoords[,2])
plot(toplot, col=labels, pch=16, cex=2)
CellCoordinates <- toplot
pal_labels <- brewer.pal(length(unique(labels)), "Set2")
colorcells=pal_labels[labels]
svg(filename="~/Documents/presentations/2017-04_PROSSTT_paper/pics/double_bif.svg", height=4.8, width=6)
par(mar=c(4.1, 5.1, 2.1, 5.1))
plot(CellCoordinates[,1], CellCoordinates[,2], pch=16, col="black",
xlab="DC1", ylab="DC2", cex=2, cex.lab=1.5, cex.axis=1.5)
points(CellCoordinates[,1], CellCoordinates[,2], pch=16, col=colorcells,
xlab="DC1", ylab="DC2", cex=1.5, cex.lab=1.5, cex.axis=1.5)
legend("right", legend=levels(ds$branch), pt.bg=pal_labels, pch=21, title="Branch",
xpd=TRUE, inset=c(-0.25,0), bty="n", cex=1.5)
dev.off()
dev.off()
plot(CellCoordinates[,1], CellCoordinates[,2], pch=16, col="black",
xlab="DC1", ylab="DC2", cex=2, cex.lab=1.5, cex.axis=1.5)
points(CellCoordinates[,1], CellCoordinates[,2], pch=16, col=colorcells,
xlab="DC1", ylab="DC2", cex=1.5, cex.lab=1.5, cex.axis=1.5)
legend("right", legend=levels(ds$branch), pt.bg=pal_labels, pch=21, title="Branch",
xpd=TRUE, inset=c(-0.25,0), bty="n", cex=1.5)
ds <- data.frame(DC1=eigenvectors(dif)[,1], DC2=eigenvectors(dif)[,2], DC3=eigenvectors(dif)[,3],
DC4=eigenvectors(dif)[,4], branch=labels)
ds$branch
svg(filename="~/Documents/presentations/2017-04_PROSSTT_paper/pics/double_bif.svg", height=4.8, width=6)
par(mar=c(4.1, 5.1, 2.1, 5.1))
plot(CellCoordinates[,1], CellCoordinates[,2], pch=16, col="black",
xlab="DC1", ylab="DC2", cex=2, cex.lab=1.5, cex.axis=1.5)
points(CellCoordinates[,1], CellCoordinates[,2], pch=16, col=colorcells,
xlab="DC1", ylab="DC2", cex=1.5, cex.lab=1.5, cex.axis=1.5)
legend("right", legend=unique(ds$branch), pt.bg=pal_labels, pch=21, title="Branch",
xpd=TRUE, inset=c(-0.25,0), bty="n", cex=1.5)
dev.off()
library(viridis)
library(RColorBrewer)
library(destiny)
rotation_matrix <- function(comp1, comp2, angle) {
rot <- diag(3)
theta <- angle / 180 * pi
rot[comp1, comp1] <- cos(theta)
rot[comp1, comp2] <- -sin(theta)
rot[comp2, comp1] <- sin(theta)
rot[comp2, comp2] <- cos(theta)
return(rot)
}
getwd()
dirname(sys.frame(1)$ofile)
sys.frame()
sys.frame()$ofile
parent.frame()
parent.frame()$ofile
parent.frame(2)$ofile
parent.frame(1)$ofile
?parent.frame
parent.frame(2)
dirname(parent.frame(2))
parent.frame(2)
parent.frame(2)$ofile
dirname(parent.frame(2)$ofile)
parent.frame(2)$ofile
parent.frame(1)$ofile
parent.frame(3)$ofile
parent.frame(0)$ofile
parent.frame()$ofile
sys.frame(-1)
sys.frame(which=-1)
guo <- read.table(file="../data/GuoDescription.txt",
sep="\t", header = T, stringsAsFactors = F, check.names = F, row.names = 1)
get_scriptpath <- function() {
# location of script can depend on how it was invoked:
# source() and knit() put it in sys.calls()
path <- NULL
if(!is.null(sys.calls())) {
# get name of script - hope this is consisitent!
path <- as.character(sys.call(1))[2]
# make sure we got a file that ends in .R, .Rmd or .Rnw
if (grepl("..+\\.[R|Rmd|Rnw]", path, perl=TRUE, ignore.case = TRUE) )  {
return(path)
} else {
message("Obtained value for path does not end with .R, .Rmd or .Rnw: ", path)
}
} else{
# Rscript and R -f put it in commandArgs
args <- commandArgs(trailingOnly = FALSE)
}
return(path)
}
get_scriptpath()
get_scriptpath()
setwd("~/Documents/repos/prosstt/scripts/")
library(viridis)
library(RColorBrewer)
library(destiny)
setwd("~/Documents/repos/prosstt/scripts/")
rotation_matrix <- function(comp1, comp2, angle) {
rot <- diag(3)
theta <- angle / 180 * pi
rot[comp1, comp1] <- cos(theta)
rot[comp1, comp2] <- -sin(theta)
rot[comp2, comp1] <- sin(theta)
rot[comp2, comp2] <- cos(theta)
return(rot)
}
guo <- read.table(file="../data/GuoDescription.txt",
sep="\t", header = T, stringsAsFactors = F, check.names = F, row.names = 1)
guo <- read.table(file="../data/guo/GuoDescription.txt",
sep="\t", header = T, stringsAsFactors = F, check.names = F, row.names = 1)
guoft <- read.table("../data/guo/GuoFeatures.txt")
data = guo
stage = as.factor(guoft$V4)
dm <- DiffusionMap(data, sigma = "global")
d = 3
trcoords <- sweep(eigenvectors(dm)[,1:d], eigenvalues(dm)[1:d], MARGIN=2, `*`)
plot(trcoords[,1:2])
rot <- rotation_matrix(comp1 = 1, comp2 = 3, angle = 30)
coords = trcoords[,1:3]
tcoords = coords %*% rot
toplot <- cbind(dm@eigenvectors[,2], tcoords[,1], dm@eigenvectors[,3])
plot(toplot[,1], toplot[,2], pch=16, col="black",
xlab="DC2", ylab="transformed DC1", cex=1, cex.lab=1.5, cex.axis=1.5)
plot(tcoords[,1], tcoords[,2], pch=16, col="black",
xlab="DC2", ylab="transformed DC1", cex=1, cex.lab=1.5, cex.axis=1.5)
plot(tcoords[,1], tcoords[,3], pch=16, col="black",
xlab="DC2", ylab="transformed DC1", cex=1, cex.lab=1.5, cex.axis=1.5)
plot(tcoords[,2], tcoords[,3], pch=16, col="black",
xlab="DC2", ylab="transformed DC1", cex=1, cex.lab=1.5, cex.axis=1.5)
plot(toplot[,1], toplot[,2], pch=16, col="black",
xlab="DC2", ylab="transformed DC1", cex=1, cex.lab=1.5, cex.axis=1.5)
pal_labels = viridis(length(unique(stage)), option = "viridis")
colorcells = pal_labels[stage]
plot(toplot[,1], toplot[,2], pch=16, col="black",
xlab="DC2", ylab="transformed DC1", cex=2, cex.lab=1.5, cex.axis=1.5)
points(toplot[,1], toplot[,2], pch=16, col=colorcells,
xlab="DC2", ylab="transformed DC1", cex=1.5, cex.lab=1.5, cex.axis=1.5)
rot <- rotation_matrix(comp1 = 1, comp2 = 3, angle = -30)
coords = trcoords[,1:3]
tcoords = coords %*% rot
toplot <- cbind(dm@eigenvectors[,2], tcoords[,1], dm@eigenvectors[,3])
plot(toplot[,1], toplot[,2], pch=16, col="black",
xlab="DC2", ylab="transformed DC1", cex=1, cex.lab=1.5, cex.axis=1.5)
